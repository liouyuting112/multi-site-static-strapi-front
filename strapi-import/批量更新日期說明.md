# 📅 批量更新文章日期工具使用說明

## 功能說明

這個工具可以幫助你：
1. **批量更新所有文章的日期** - 根據 slug 自動提取日期（例如：`2023-12-01.html` → `2023-12-01`）
2. **手動指定日期更新** - 可以指定一個日期，更新所有 daily 文章或所有文章
3. **查看所有文章的當前日期** - 方便檢查和確認

## 使用方法

### 1. 進入工具目錄

```bash
cd strapi-import
```

### 2. 運行工具

```bash
npm run update-dates
```

### 3. 選擇功能

工具會顯示以下選項：

```
選項：
1. 根據 slug 自動提取日期（例如：2023-12-01.html -> 2023-12-01）
2. 手動指定日期更新所有 daily 文章
3. 手動指定日期更新所有文章
4. 查看所有文章的當前日期
```

## 使用場景

### 場景 1：初始化所有文章的日期

如果你有很多文章，想要根據文件名（slug）自動設置日期：

1. 選擇選項 `1`
2. 工具會自動從 slug 中提取日期（例如：`2023-12-01.html` → `2023-12-01`）
3. 自動更新所有文章的日期

### 場景 2：每天更新新文章

當你發布新文章時：

1. **新文章加入 Strapi** - 新文章的日期會自動設為今天
2. **每日精選自動更新** - 因為 `home-cms.js` 已經按 `createdAt:desc` 排序，最新的文章會自動顯示在最前面
3. **舊文章自動往後移** - 舊文章會自動排在後面

### 場景 3：手動調整日期

如果你想手動調整所有 daily 文章的日期：

1. 選擇選項 `2`
2. 輸入日期（格式：`YYYY-MM-DD`，例如：`2023-12-02`）
3. 所有 daily 文章的日期會更新為指定日期

### 場景 4：查看當前日期

如果你想查看所有文章的當前日期：

1. 選擇選項 `4`
2. 工具會顯示所有文章的標題、slug、當前日期等信息

## 工作原理

### 日期排序

`home-cms.js` 已經配置為按日期降序排序：

```javascript
const url = `${STRAPI_URL}/api/posts?filters[site][$eq]=${site}&filters[category][$eq]=${category}&sort=createdAt:desc`;
```

這意味著：
- **最新的文章會顯示在最前面**
- 當你添加新文章時，它會自動成為"每日精選"的第一篇
- 舊文章會自動往後移

### 每日精選顯示邏輯

`home-cms.js` 會：
1. 從 Strapi 獲取所有 `category: 'daily'` 的文章
2. 按 `createdAt:desc` 排序（最新的在前）
3. 只顯示前 3 篇（`posts.slice(0, 3)`）

所以：
- 當你添加新文章（日期為今天）時，它會自動成為每日精選的第一篇
- 昨天的文章會自動變成第二篇
- 前天的文章會自動變成第三篇
- 更舊的文章會自動被擠出每日精選（但文章本身還在，只是不在首頁顯示）

## 注意事項

1. **日期格式**：必須使用 `YYYY-MM-DD` 格式（例如：`2023-12-02`）
2. **Strapi 必須運行**：確保 Strapi 服務器正在運行（`http://localhost:1337`）
3. **API Token**：如果 Strapi 需要認證，請確保 `STRAPI_TOKEN` 環境變量已設置

## 範例

### 範例 1：自動提取日期

假設你有以下文章：
- `2023-12-03.html` → 日期會設為 `2023-12-03`
- `2023-12-02.html` → 日期會設為 `2023-12-02`
- `2023-12-01.html` → 日期會設為 `2023-12-01`

運行選項 1 後，所有文章的日期會自動更新。

### 範例 2：每天更新流程

1. **12/1**：發布文章 A（日期：2023-12-01）
   - 每日精選顯示：A

2. **12/2**：發布文章 B（日期：2023-12-02）
   - 每日精選顯示：B, A
   - 文章 A 自動往後移

3. **12/3**：發布文章 C（日期：2023-12-03）
   - 每日精選顯示：C, B, A
   - 文章 B 和 A 自動往後移

4. **12/4**：發布文章 D（日期：2023-12-04）
   - 每日精選顯示：D, C, B
   - 文章 A 被擠出每日精選（但文章還在，只是不在首頁顯示）

## 常見問題

**Q: 如果我想要手動調整某篇文章的日期怎麼辦？**

A: 可以使用選項 2 或 3，或者直接在 Strapi 後台手動修改。

**Q: 如果我的文章 slug 沒有日期格式怎麼辦？**

A: 工具會跳過這些文章，你可以使用選項 2 或 3 手動指定日期。

**Q: 更新日期後，首頁會自動更新嗎？**

A: 是的，因為 `home-cms.js` 會按日期排序，刷新首頁後會自動顯示最新的文章。




